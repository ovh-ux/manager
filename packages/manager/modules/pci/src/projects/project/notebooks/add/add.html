<div>
    <oui-header data-heading="{{:: 'pci_notebook_add_title' | translate }}">
        <oui-guide-menu data-text="{{:: 'pci_project_guides_header' | translate }}">
            <oui-guide-menu-item data-href="{{ $ctrl.guideUrl }}" data-external>
                <span data-translate="pci_project_guides_header_all_guides"></span>
            </oui-guide-menu-item>
        </oui-guide-menu>
    </oui-header>

    <p data-translate="pci_notebook_add_description"></p>
</div>

<!--Banner messages-->
<div class="mt-4" id="addMessages">
    <oui-message data-type="info">
        <span data-translate="pci_notebook_add_banner_object_storage_description"></span>
        <a
            data-ng-href="{{ $ctrl.storageAddObjectLink }}"
            data-translate="pci_notebook_add_banner_object_storage_description_link"
            target="_blank"
        >
        </a>
    </oui-message>

    <cui-message-container
        data-messages="$ctrl.messages"
    ></cui-message-container>
</div>

<!--Notebook stepper-->
<oui-stepper data-current-index="$ctrl.currentStep"
             data-on-finish="$ctrl.onNotebookSubmit()">

    <!--Notebook Configuration-->
    <oui-step-form
        data-name="notebook_settings"
        data-header="{{ $ctrl.getConfigHeader($ctrl.currentStep) }}"
        data-on-focus="$ctrl.displayNotebookConfiguration = true"
        data-on-submit="$ctrl.displayNotebookConfiguration = false"
        data-prevent-next="true"
    >
        <notebook-configuration
            data-display-notebook-configuration="$ctrl.displayNotebookConfiguration"
            data-notebook-model="$ctrl.notebookModel"></notebook-configuration>
    </oui-step-form>

    <!--Notebook Editors-->
    <oui-step-form
        data-name="notebook_framework"
        data-header="{{ $ctrl.getEditorHeader($ctrl.currentStep) }}"
        data-on-focus="$ctrl.displayNotebookEditors = true"
        data-on-submit="$ctrl.displayNotebookEditors = false"
        data-valid="$ctrl.notebookModel.selected.editor"
        data-prevent-next="true"
    >
        <notebook-editors-list
            data-display-notebook-editors="$ctrl.displayNotebookEditors"
            data-notebook-model="$ctrl.notebookModel"
            data-editors="$ctrl.editors"></notebook-editors-list>
    </oui-step-form>

    <!--Notebook Framework-->
    <oui-step-form
        data-name="notebook_framework"
        data-header="{{ $ctrl.getFrameworkHeader($ctrl.currentStep) }}"
        data-on-focus="$ctrl.displayNotebookFramework = true"
        data-on-submit="$ctrl.displayNotebookFramework = false"
        data-valid="$ctrl.notebookModel.selected.framework.model"
        data-prevent-next="true"
    >
        <notebook-frameworks-list
            data-display-notebook-framework="$ctrl.displayNotebookFramework"
            data-notebook-model="$ctrl.notebookModel"
            data-frameworks="$ctrl.frameworks"></notebook-frameworks-list>
    </oui-step-form>

    <!--Notebook Privacy Settings-->
    <oui-step-form
        data-name="notebook_private_settings"
        data-header="{{ $ctrl.getPrivacyHeader($ctrl.currentStep) }}"
        data-on-focus="$ctrl.displayNotebookPrivacySettings = true"
        data-on-submit="$ctrl.displayNotebookPrivacySettings = false"
        data-navigation="$ctrl.notebookModel.selected.privacy"
    >
        <notebook-privacy-settings
            data-display-notebook-privacy-settings="$ctrl.displayNotebookPrivacySettings"
            data-notebook-model="$ctrl.notebookModel"></notebook-privacy-settings>
    </oui-step-form>

    <!--Notebook Datacenter Location-->
    <oui-step-form
        data-name="notebook_datacenter_location"
        data-header="{{ $ctrl.getRegionHeader($ctrl.currentStep) }}"
        data-on-focus="$ctrl.displayNotebookDatacenterLocation = true"
        data-on-submit="$ctrl.displayNotebookDatacenterLocation = false"
        data-valid="$ctrl.notebookModel.selected.region"
        data-prevent-next="true"
    >
        <div data-ng-if="$ctrl.displayNotebookDatacenterLocation">
            <p data-translate="pci_notebook_add_privacy_datacenter_location_description"></p>
            <pci-project-regions-list
                data-regions="$ctrl.regions"
                data-selected-region="$ctrl.notebookModel.selected.region"
                data-display-selected-region="$ctrl.displaySelectedRegion"
                data-on-change="$ctrl.onRegionChange(region)"
            ></pci-project-regions-list>
        </div>
    </oui-step-form>

    <!--Notebook Resources-->
    <oui-step-form
        data-name="notebook_resources"
        data-header="{{ $ctrl.getResourceHeader($ctrl.currentStep) }}"
        data-loading="!$ctrl.flavorsAreLoaded"
        data-on-focus="$ctrl.displayNotebookResources = true"
        data-on-submit="$ctrl.displayNotebookResources = false"
        data-valid="$ctrl.notebookModel.selected.resource.usage && $ctrl.notebookModel.selected.resource.flavor"
        data-prevent-next="true"
    >
        <notebook-resources
            data-ng-if="$ctrl.flavors"
            data-display-notebook-resources="$ctrl.displayNotebookResources"
            data-notebook-model="$ctrl.notebookModel"
            data-flavors="$ctrl.flavors"
            data-prices="$ctrl.prices"></notebook-resources>
    </oui-step-form>

    <!--Notebook Attach Container and Repository-->
    <oui-step-form
        data-name="notebook_attach"
        data-header="{{ $ctrl.getAttachContainerHeader($ctrl.currentStep) }}"
        data-on-focus="$ctrl.displayNotebookAttach = true"
        data-on-submit="$ctrl.displayNotebookAttach = false"
        data-prevent-next="true"
    >
        <notebook-attach
            data-display-notebook-attach="$ctrl.displayNotebookAttach"
            data-notebook-model="$ctrl.notebookModel"
            data-storages="$ctrl.storages"></notebook-attach>
    </oui-step-form>

    <!--Notebook Review-->
    <oui-step-form
        data-name="notebook_attach"
        data-header="{{:: 'pci_notebook_add_review_title' | translate }}"
        data-submit-text="{{:: 'pci_notebook_add_notebook_create' | translate }}"
        data-loading-text="{{:: 'pci_notebook_add_notebook_create_pending' | translate }}"
        data-on-focus="$ctrl.displayNotebookReview = true"
        data-on-submit="$ctrl.displayNotebookReview = false"
        data-editable="!$ctrl.isAdding"
        data-loading="$ctrl.isAdding"
    >
        <notebook-review
            data-ng-if="$ctrl.displayNotebookReview"
            data-project-id="$ctrl.projectId"
            data-convert-notebook-model="$ctrl.constructor.convertNotebookModel"
            data-display-notebook-review="$ctrl.displayNotebookReview"
            data-notebook-model="$ctrl.notebookModel"
            data-prices="$ctrl.prices"></notebook-review>
    </oui-step-form>

</oui-stepper>
