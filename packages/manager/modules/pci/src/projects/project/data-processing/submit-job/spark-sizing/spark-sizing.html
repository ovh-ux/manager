<p data-translate="data_processing_submit_job_sizing_description"></p>
<div ng-if="!$ctrl.state.advancedSizing">
    <form novalidate name="sizingForm">
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_driver_template_label' | translate }}"
            data-size="l"
        >
            <label class="oui-select">
                <select
                    name="driver-template"
                    class="oui-select__input"
                    data-ng-model="$ctrl.state.driverTemplate"
                    data-ng-change="$ctrl.updateStateFromTemplate()"
                    required
                >
                    <option
                        ng-repeat="template in $ctrl.driverTemplates track by template.id"
                        value="{{ template.id }}"
                    >
                        {{ :: template.cores }} {{ ::
                        'data_processing_submit_job_sizing_template_cores_label'
                        | translate }} - {{ :: template.memory/1e9 }} {{ ::
                        'data_processing_submit_job_sizing_template_memory_label'
                        | translate }}
                    </option>
                </select>
                <span
                    class="oui-icon oui-icon-chevron-down"
                    aria-hidden="true"
                ></span>
            </label>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_worker_template_label' | translate }}"
            data-size="l"
        >
            <label class="oui-select">
                <select
                    name="worker-template"
                    class="oui-select__input"
                    data-ng-model="$ctrl.state.workerTemplate"
                    data-ng-change="$ctrl.updateStateFromTemplate()"
                    required
                >
                    <option
                        ng-repeat="template in $ctrl.workerTemplates"
                        value="{{ template.id }}"
                    >
                        {{ :: template.cores }} {{ ::
                        'data_processing_submit_job_sizing_template_cores_label'
                        | translate }} - {{ :: template.memory/1e9 }} {{ ::
                        'data_processing_submit_job_sizing_template_memory_label'
                        | translate }}
                    </option>
                </select>
                <span
                    class="oui-icon oui-icon-chevron-down"
                    aria-hidden="true"
                ></span>
            </label>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_worker_count_label' | translate }}"
            data-help-text="{{:: 'data_processing_submit_job_stepper_spark_worker_count_description' | translate }}"
        >
            <oui-numeric
                name="worker-count"
                data-model="$ctrl.state.workerCount"
                data-min="1"
                data-max="10"
            >
            </oui-numeric>
        </oui-field>
        <div class="sizing__pricing">
            {{ :: 'data_processing_submit_job_stepper_spark_estimated_price' |
            translate }}
            <strong>{{ $ctrl.computePrice().toFixed(3) }}€/min</strong>
        </div>
        <button
            class="oui-button oui-button_link sizing__advanced-button"
            type="button"
            data-ng-click="$ctrl.onClickAdvancedConfigurationHandler()"
        >
            {{ :: 'data_processing_submit_job_stepper_spark_advanced' |
            translate }}
        </button>
    </form>
</div>
<div ng-if="$ctrl.state.advancedSizing">
    <form novalidate name="advancedSizingForm">
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_driver_cores_label' | translate }}"
        >
            <div class="sizing__advanced-units-container">
                <oui-numeric
                    name="driver-cores"
                    data-model="$ctrl.state.driverCores"
                    data-min="1"
                    data-max="8"
                >
                </oui-numeric>
            </div>
            <span class="sizing__advanced-units">vCores</span>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_driver_memory_label' | translate }}"
        >
            <div class="sizing__advanced-units-container">
                <oui-numeric
                    name="driver-memory"
                    data-model="$ctrl.state.driverMemoryGb"
                    data-min="1"
                    data-max="30"
                >
                </oui-numeric>
            </div>
            <span class="sizing__advanced-units">GB</span>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_driver_memory_overhead_label' | translate }}"
        >
            <div class="sizing__advanced-units-container">
                <oui-numeric
                    name="driver-memory-overhead"
                    data-model="$ctrl.state.driverMemoryOverheadMb"
                    data-min="$ctrl.minMemoryOverheadMb"
                    data-max="30000"
                >
                </oui-numeric>
            </div>
            <span class="sizing__advanced-units">MB</span>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_worker_cores_label' | translate }}"
        >
            <div class="sizing__advanced-units-container">
                <oui-numeric
                    name="worker-cores"
                    data-model="$ctrl.state.workerCores"
                    data-min="1"
                    data-max="8"
                >
                </oui-numeric>
            </div>
            <span class="sizing__advanced-units">vCores</span>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_worker_memory_label' | translate }}"
            data-help-text="{{:: 'data_processing_submit_job_stepper_spark_worker_memory_description' | translate }}"
        >
            <div class="sizing__advanced-units-container">
                <oui-numeric
                    name="worker-memory"
                    data-model="$ctrl.state.workerMemoryGb"
                    data-min="1"
                    data-max="30"
                >
                </oui-numeric>
            </div>
            <span class="sizing__advanced-units">GB</span>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_worker_memory_overhead_label' | translate }}"
        >
            <div class="sizing__advanced-units-container">
                <oui-numeric
                    name="worker-memory-overhead"
                    data-model="$ctrl.state.workerMemoryOverheadMb"
                    data-min="$ctrl.minMemoryOverheadMb"
                    data-max="30000"
                >
                </oui-numeric>
            </div>
            <span class="sizing__advanced-units">MB</span>
        </oui-field>
        <oui-field
            data-label="{{:: 'data_processing_submit_job_stepper_spark_worker_count_label' | translate }}"
        >
            <oui-numeric
                name="worker-count"
                data-model="$ctrl.state.workerCount"
                data-min="1"
                data-max="10"
            >
            </oui-numeric>
        </oui-field>
        <div class="sizing__pricing">
            {{ :: 'data_processing_submit_job_stepper_spark_estimated_price' |
            translate }}
            <strong
                ><span ng-bind="$ctrl.computePrice().toFixed(3)"></span
                >€/min</strong
            >
        </div>
        <button
            class="oui-button oui-button_link sizing__advanced-button"
            type="button"
            data-ng-click="$ctrl.onClickAdvancedConfigurationHandler()"
        >
            {{ :: 'data_processing_submit_job_stepper_spark_standard' |
            translate }}
        </button>
    </form>
</div>
